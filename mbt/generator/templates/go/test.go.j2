// Code generated by fizzbee-mbt generator; DO NOT EDIT.

package {{ package_name }}

import (
    "testing"

    mbt "github.com/fizzbee-io/fizzbee/mbt/lib/go"
)

// Registry keyed by role type ("" means top-level model actions)
var actionRegistry = map[string]map[string]mbt.ActionFunc{
    "": {
        {%- for action in file.actions %}
        {%- if action.name != "Init" %}
        "{{ action.name }}": func(inst any, args []mbt.Arg) (any, error) {
            return inst.({{ model_name }}Model).Action{{ action.name }}(args)
        },
        {%- endif %}
        {%- endfor %}
    },
    {%- for role in file.roles %}
    "{{ role.name }}": {
        {%- for action in role.actions %}
        {%- if action.name != "Init" %}
        "{{ action.name }}": func(inst any, args []mbt.Arg) (any, error) {
            return inst.({{ role.name }}Role).Action{{ action.name }}(args)
        },
        {%- endif %}
        {%- endfor %}
    },
    {%- endfor %}
}

func Test{{ model_name }}(t *testing.T) {
    model := New{{ model_name }}Model()
    opts := mbt.StartOptions{
        Network: mbt.NetworkUDS,
        Address: "/tmp/fizzbee_mbt.sock",
    }
    mbt.Start(t, model, actionRegistry, opts)
}
